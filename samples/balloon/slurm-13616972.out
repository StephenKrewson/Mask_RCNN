The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) StdEnv
Restoring modules from user's cuda, for system: "grace-rhel7"
2018-05-22 21:32:52.822555: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
WARNING:tensorflow:From /home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/datasets/base.py:198: retry (from tensorflow.contrib.learn.python.learn.datasets.base) is deprecated and will be removed in a future version.
Instructions for updating:
Use the retry module or similar alternatives.
Weights:  coco
Dataset:  ../../datasets/illustrations
Logs:  /gpfs/loomis/project/fas/leonard/swk2/Mask_RCNN/logs

Configurations:
BACKBONE                       resnet101
BACKBONE_STRIDES               [4, 8, 16, 32, 64]
BATCH_SIZE                     2
BBOX_STD_DEV                   [0.1 0.1 0.2 0.2]
DETECTION_MAX_INSTANCES        100
DETECTION_MIN_CONFIDENCE       0.9
DETECTION_NMS_THRESHOLD        0.3
GPU_COUNT                      1
GRADIENT_CLIP_NORM             5.0
IMAGES_PER_GPU                 2
IMAGE_MAX_DIM                  1024
IMAGE_META_SIZE                14
IMAGE_MIN_DIM                  800
IMAGE_MIN_SCALE                0
IMAGE_RESIZE_MODE              square
IMAGE_SHAPE                    [1024 1024    3]
LEARNING_MOMENTUM              0.9
LEARNING_RATE                  0.001
LOSS_WEIGHTS                   {'rpn_class_loss': 1.0, 'rpn_bbox_loss': 1.0, 'mrcnn_class_loss': 1.0, 'mrcnn_bbox_loss': 1.0, 'mrcnn_mask_loss': 1.0}
MASK_POOL_SIZE                 14
MASK_SHAPE                     [28, 28]
MAX_GT_INSTANCES               100
MEAN_PIXEL                     [123.7 116.8 103.9]
MINI_MASK_SHAPE                (56, 56)
NAME                           balloon
NUM_CLASSES                    2
POOL_SIZE                      7
POST_NMS_ROIS_INFERENCE        1000
POST_NMS_ROIS_TRAINING         2000
ROI_POSITIVE_RATIO             0.33
RPN_ANCHOR_RATIOS              [0.5, 1, 2]
RPN_ANCHOR_SCALES              (32, 64, 128, 256, 512)
RPN_ANCHOR_STRIDE              1
RPN_BBOX_STD_DEV               [0.1 0.1 0.2 0.2]
RPN_NMS_THRESHOLD              0.7
RPN_TRAIN_ANCHORS_PER_IMAGE    256
STEPS_PER_EPOCH                100
TRAIN_BN                       False
TRAIN_ROIS_PER_IMAGE           200
USE_MINI_MASK                  True
USE_RPN_ROIS                   True
VALIDATION_STEPS               50
WEIGHT_DECAY                   0.0001


Loading weights  /gpfs/loomis/project/fas/leonard/swk2/Mask_RCNN/mask_rcnn_coco.h5
Training network heads

Starting at epoch 0. LR=0.001

Checkpoint Path: /gpfs/loomis/project/fas/leonard/swk2/Mask_RCNN/logs/balloon20180522T2132/mask_rcnn_balloon_{epoch:04d}.h5
Selecting layers to train
fpn_c5p5               (Conv2D)
fpn_c4p4               (Conv2D)
fpn_c3p3               (Conv2D)
fpn_c2p2               (Conv2D)
fpn_p5                 (Conv2D)
fpn_p2                 (Conv2D)
fpn_p3                 (Conv2D)
fpn_p4                 (Conv2D)
In model:  rpn_model
    rpn_conv_shared        (Conv2D)
    rpn_class_raw          (Conv2D)
    rpn_bbox_pred          (Conv2D)
mrcnn_mask_conv1       (TimeDistributed)
mrcnn_mask_bn1         (TimeDistributed)
mrcnn_mask_conv2       (TimeDistributed)
mrcnn_mask_bn2         (TimeDistributed)
mrcnn_class_conv1      (TimeDistributed)
mrcnn_class_bn1        (TimeDistributed)
mrcnn_mask_conv3       (TimeDistributed)
mrcnn_mask_bn3         (TimeDistributed)
mrcnn_class_conv2      (TimeDistributed)
mrcnn_class_bn2        (TimeDistributed)
mrcnn_mask_conv4       (TimeDistributed)
mrcnn_mask_bn4         (TimeDistributed)
mrcnn_bbox_fc          (TimeDistributed)
mrcnn_mask_deconv      (TimeDistributed)
mrcnn_class_logits     (TimeDistributed)
mrcnn_mask             (TimeDistributed)
/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py:100: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/keras/engine/training.py:2087: UserWarning: Using a generator with `use_multiprocessing=True` and multiple workers may duplicate your data. Please consider using the`keras.utils.Sequence class.
  UserWarning('Using a generator with `use_multiprocessing=True`'
ERROR:root:Error processing image {'id': 'b21915635_0002_0116.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21915635_0002_0116.jpg', 'width': 1886, 'height': 3313, 'polygons': [{'name': 'rect', 'x': 430, 'y': 1473, 'width': 1178, 'height': 686}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '63861710R_0071.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/63861710R_0071.jpg', 'width': 2244, 'height': 3558, 'polygons': [{'name': 'rect', 'x': 514, 'y': 1353, 'width': 1282, 'height': 532}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'exceptionalchild00roma_0013.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/exceptionalchild00roma_0013.jpg', 'width': 2853, 'height': 2081, 'polygons': [{'name': 'rect', 'x': 173, 'y': 445, 'width': 2130, 'height': 1341}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'transactionsstud4161coll_0123.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/transactionsstud4161coll_0123.jpg', 'width': 2204, 'height': 3345, 'polygons': [{'name': 'rect', 'x': 46, 'y': 219, 'width': 2002, 'height': 1558}, {'name': 'rect', 'x': 388, 'y': 1853, 'width': 1299, 'height': 1021}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2150751x_0001_0585.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2150751x_0001_0585.jpg', 'width': 2025, 'height': 3331, 'polygons': [{'name': 'rect', 'x': 937, 'y': 1200, 'width': 729, 'height': 930}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'gynecology00grav_0787.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/gynecology00grav_0787.jpg', 'width': 2329, 'height': 3708, 'polygons': [{'name': 'rect', 'x': 165, 'y': 918, 'width': 1958, 'height': 1528}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'gynecology00grav_0787.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/gynecology00grav_0787.jpg', 'width': 2329, 'height': 3708, 'polygons': [{'name': 'rect', 'x': 165, 'y': 918, 'width': 1958, 'height': 1528}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'principlespracti00bedf_0066.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/principlespracti00bedf_0066.jpg', 'width': 2493, 'height': 4262, 'polygons': [{'name': 'rect', 'x': 569, 'y': 2607, 'width': 1375, 'height': 1050}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '39002086340552.med.yale.edu_0389.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/39002086340552.med.yale.edu_0389.jpg', 'width': 1378, 'height': 2309, 'polygons': [{'name': 'rect', 'x': 112, 'y': 343, 'width': 1133, 'height': 1798}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2804874x_0074.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2804874x_0074.jpg', 'width': 1603, 'height': 2493, 'polygons': [{'name': 'rect', 'x': 225, 'y': 657, 'width': 1329, 'height': 237}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'bulletinofuniver6767_0157.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/bulletinofuniver6767_0157.jpg', 'width': 1855, 'height': 2877, 'polygons': [{'name': 'rect', 'x': 541, 'y': 117, 'width': 1234, 'height': 1214}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b21357298_0133.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21357298_0133.jpg', 'width': 1660, 'height': 2826, 'polygons': [{'name': 'rect', 'x': 115, 'y': 647, 'width': 1257, 'height': 1366}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '63571000R_0947.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/63571000R_0947.jpg', 'width': 1980, 'height': 3528, 'polygons': [{'name': 'rect', 'x': 496, 'y': 1502, 'width': 1083, 'height': 1582}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'manualofoperativ00stim_0138.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/manualofoperativ00stim_0138.jpg', 'width': 2107, 'height': 3489, 'polygons': [{'name': 'rect', 'x': 594, 'y': 715, 'width': 919, 'height': 2072}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'glimpseofindiabe1909swai_0245.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/glimpseofindiabe1909swai_0245.jpg', 'width': 2106, 'height': 3360, 'polygons': [{'name': 'rect', 'x': 203, 'y': 526, 'width': 1461, 'height': 2069}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'proceedings16newy_0178.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/proceedings16newy_0178.jpg', 'width': 2133, 'height': 3495, 'polygons': [{'name': 'rect', 'x': 398, 'y': 1125, 'width': 1434, 'height': 1389}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2150037x_0038.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2150037x_0038.jpg', 'width': 2304, 'height': 3536, 'polygons': [{'name': 'rect', 'x': 263, 'y': 945, 'width': 1089, 'height': 427}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '39002086340552.med.yale.edu_0389.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/39002086340552.med.yale.edu_0389.jpg', 'width': 1378, 'height': 2309, 'polygons': [{'name': 'rect', 'x': 112, 'y': 343, 'width': 1133, 'height': 1798}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'anaestheticsthei1914buxt_0281.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/anaestheticsthei1914buxt_0281.jpg', 'width': 1959, 'height': 3136, 'polygons': [{'name': 'rect', 'x': 618, 'y': 705, 'width': 540, 'height': 817}, {'name': 'rect', 'x': 1332, 'y': 1990, 'width': 369, 'height': 649}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b29123082_0081.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b29123082_0081.jpg', 'width': 2024, 'height': 3346, 'polygons': [{'name': 'rect', 'x': 23, 'y': 788, 'width': 1988, 'height': 1534}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'textbookofbotany00strauoft_0416.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/textbookofbotany00strauoft_0416.jpg', 'width': 1918, 'height': 3216, 'polygons': [{'name': 'rect', 'x': 143, 'y': 519, 'width': 895, 'height': 386}, {'name': 'rect', 'x': 857, 'y': 1201, 'width': 879, 'height': 1265}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'differentialdiag002cabo_0117.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/differentialdiag002cabo_0117.jpg', 'width': 2102, 'height': 3453, 'polygons': [{'name': 'rect', 'x': 362, 'y': 885, 'width': 1142, 'height': 1477}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '39002086340552.med.yale.edu_0389.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/39002086340552.med.yale.edu_0389.jpg', 'width': 1378, 'height': 2309, 'polygons': [{'name': 'rect', 'x': 112, 'y': 343, 'width': 1133, 'height': 1798}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'gynecology00grav_0127.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/gynecology00grav_0127.jpg', 'width': 2329, 'height': 3708, 'polygons': [{'name': 'rect', 'x': 198, 'y': 1227, 'width': 1888, 'height': 1271}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2193311x_0654.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2193311x_0654.jpg', 'width': 1759, 'height': 3008, 'polygons': [{'name': 'rect', 'x': 193, 'y': 95, 'width': 1369, 'height': 2708}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b21932323_0509.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21932323_0509.jpg', 'width': 1811, 'height': 2946, 'polygons': [{'name': 'rect', 'x': 198, 'y': 271, 'width': 1309, 'height': 1455}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '67440190R_0259.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/67440190R_0259.jpg', 'width': 3357, 'height': 4424, 'polygons': [{'name': 'rect', 'x': 596, 'y': 618, 'width': 1898, 'height': 1451}, {'name': 'rect', 'x': 543, 'y': 2331, 'width': 1998, 'height': 1437}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'newjerseymedicin9611medi_0202.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/newjerseymedicin9611medi_0202.jpg', 'width': 2623, 'height': 3742, 'polygons': [{'name': 'rect', 'x': 170, 'y': 571, 'width': 2397, 'height': 2808}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'differentialdiag002cabo_0623.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/differentialdiag002cabo_0623.jpg', 'width': 2041, 'height': 3441, 'polygons': [{'name': 'rect', 'x': 460, 'y': 1046, 'width': 1145, 'height': 1250}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'missourimedicine5611miss_0352.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/missourimedicine5611miss_0352.jpg', 'width': 2513, 'height': 3695, 'polygons': [{'name': 'rect', 'x': 274, 'y': 530, 'width': 1075, 'height': 743}, {'name': 'rect', 'x': 271, 'y': 2052, 'width': 1075, 'height': 739}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'nursingc89unse_0048.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/nursingc89unse_0048.jpg', 'width': 2925, 'height': 3863, 'polygons': [{'name': 'rect', 'x': 1059, 'y': 570, 'width': 876, 'height': 1086}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b21286711_0231.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21286711_0231.jpg', 'width': 1812, 'height': 3270, 'polygons': [{'name': 'rect', 'x': 900, 'y': 961, 'width': 754, 'height': 1120}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'nursingc89unse_0023.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/nursingc89unse_0023.jpg', 'width': 2925, 'height': 3889, 'polygons': [{'name': 'rect', 'x': 1020, 'y': 585, 'width': 1805, 'height': 1412}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2804874x_0074.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2804874x_0074.jpg', 'width': 1603, 'height': 2493, 'polygons': [{'name': 'rect', 'x': 225, 'y': 657, 'width': 1329, 'height': 237}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'appliedanatomyor00ivyr_0028.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/appliedanatomyor00ivyr_0028.jpg', 'width': 1818, 'height': 2865, 'polygons': [{'name': 'rect', 'x': 227, 'y': 851, 'width': 1395, 'height': 1027}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b21357298_0133.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21357298_0133.jpg', 'width': 1660, 'height': 2826, 'polygons': [{'name': 'rect', 'x': 115, 'y': 647, 'width': 1257, 'height': 1366}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2804874x_0074.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2804874x_0074.jpg', 'width': 1603, 'height': 2493, 'polygons': [{'name': 'rect', 'x': 225, 'y': 657, 'width': 1329, 'height': 237}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'saudiexperimenti00prep_0045.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/saudiexperimenti00prep_0045.jpg', 'width': 2864, 'height': 4344, 'polygons': [{'name': 'rect', 'x': 189, 'y': 1028, 'width': 2421, 'height': 1656}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'manualofoperativ00stim_0138.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/manualofoperativ00stim_0138.jpg', 'width': 2107, 'height': 3489, 'polygons': [{'name': 'rect', 'x': 594, 'y': 715, 'width': 919, 'height': 2072}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'manualofoperativ00stim_0138.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/manualofoperativ00stim_0138.jpg', 'width': 2107, 'height': 3489, 'polygons': [{'name': 'rect', 'x': 594, 'y': 715, 'width': 919, 'height': 2072}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2804874x_0074.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2804874x_0074.jpg', 'width': 1603, 'height': 2493, 'polygons': [{'name': 'rect', 'x': 225, 'y': 657, 'width': 1329, 'height': 237}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'hughespracticeof1911hugh_0460.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/hughespracticeof1911hugh_0460.jpg', 'width': 2177, 'height': 3424, 'polygons': [{'name': 'rect', 'x': 241, 'y': 285, 'width': 916, 'height': 1099}, {'name': 'rect', 'x': 1285, 'y': 471, 'width': 743, 'height': 722}, {'name': 'rect', 'x': 264, 'y': 1801, 'width': 756, 'height': 763}, {'name': 'rect', 'x': 1265, 'y': 1750, 'width': 783, 'height': 807}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'anaestheticsthei1914buxt_0281.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/anaestheticsthei1914buxt_0281.jpg', 'width': 1959, 'height': 3136, 'polygons': [{'name': 'rect', 'x': 618, 'y': 705, 'width': 540, 'height': 817}, {'name': 'rect', 'x': 1332, 'y': 1990, 'width': 369, 'height': 649}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2150751x_0001_0585.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2150751x_0001_0585.jpg', 'width': 2025, 'height': 3331, 'polygons': [{'name': 'rect', 'x': 937, 'y': 1200, 'width': 729, 'height': 930}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'americanjournal46ameruoft_0062.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/americanjournal46ameruoft_0062.jpg', 'width': 2137, 'height': 3279, 'polygons': [{'name': 'rect', 'x': 552, 'y': 1137, 'width': 1156, 'height': 948}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'gynecology00grav_0453.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/gynecology00grav_0453.jpg', 'width': 2329, 'height': 3708, 'polygons': [{'name': 'rect', 'x': 169, 'y': 533, 'width': 933, 'height': 834}, {'name': 'rect', 'x': 1161, 'y': 547, 'width': 933, 'height': 816}, {'name': 'rect', 'x': 617, 'y': 1987, 'width': 1021, 'height': 896}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'americanjournal46ameruoft_0062.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/americanjournal46ameruoft_0062.jpg', 'width': 2137, 'height': 3279, 'polygons': [{'name': 'rect', 'x': 552, 'y': 1137, 'width': 1156, 'height': 948}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'terramariaemedic00unse_14_0140.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/terramariaemedic00unse_14_0140.jpg', 'width': 3527, 'height': 4678, 'polygons': [{'name': 'rect', 'x': 894, 'y': 158, 'width': 1024, 'height': 1808}, {'name': 'rect', 'x': 0, 'y': 2030, 'width': 1488, 'height': 1455}, {'name': 'rect', 'x': 1543, 'y': 2322, 'width': 1075, 'height': 1163}, {'name': 'rect', 'x': 2688, 'y': 2322, 'width': 830, 'height': 1159}, {'name': 'rect', 'x': 1974, 'y': 1242, 'width': 1539, 'height': 1010}, {'name': 'rect', 'x': 1891, 'y': 3532, 'width': 1622, 'height': 802}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '39002086340552.med.yale.edu_0389.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/39002086340552.med.yale.edu_0389.jpg', 'width': 1378, 'height': 2309, 'polygons': [{'name': 'rect', 'x': 112, 'y': 343, 'width': 1133, 'height': 1798}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b28093069_0479.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b28093069_0479.jpg', 'width': 2375, 'height': 4192, 'polygons': [{'name': 'rect', 'x': 610, 'y': 876, 'width': 1084, 'height': 1158}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '101515374X2_0024.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/101515374X2_0024.jpg', 'width': 1861, 'height': 3445, 'polygons': [{'name': 'rect', 'x': 801, 'y': 385, 'width': 975, 'height': 890}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2491051x_0259.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2491051x_0259.jpg', 'width': 2182, 'height': 3479, 'polygons': [{'name': 'rect', 'x': 134, 'y': 538, 'width': 1658, 'height': 2410}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b21932323_0260.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21932323_0260.jpg', 'width': 1811, 'height': 2946, 'polygons': [{'name': 'rect', 'x': 782, 'y': 1881, 'width': 373, 'height': 385}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'hughespracticeof1911hugh_0460.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/hughespracticeof1911hugh_0460.jpg', 'width': 2177, 'height': 3424, 'polygons': [{'name': 'rect', 'x': 241, 'y': 285, 'width': 916, 'height': 1099}, {'name': 'rect', 'x': 1285, 'y': 471, 'width': 743, 'height': 722}, {'name': 'rect', 'x': 264, 'y': 1801, 'width': 756, 'height': 763}, {'name': 'rect', 'x': 1265, 'y': 1750, 'width': 783, 'height': 807}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'differentialdiag002cabo_0463.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/differentialdiag002cabo_0463.jpg', 'width': 2041, 'height': 3441, 'polygons': [{'name': 'rect', 'x': 368, 'y': 593, 'width': 1203, 'height': 2286}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b2130175x_0620.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b2130175x_0620.jpg', 'width': 1801, 'height': 2929, 'polygons': [{'name': 'rect', 'x': 241, 'y': 740, 'width': 1421, 'height': 992}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'anaestheticsthei1914buxt_0281.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/anaestheticsthei1914buxt_0281.jpg', 'width': 1959, 'height': 3136, 'polygons': [{'name': 'rect', 'x': 618, 'y': 705, 'width': 540, 'height': 817}, {'name': 'rect', 'x': 1332, 'y': 1990, 'width': 369, 'height': 649}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '67440190R_0259.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/67440190R_0259.jpg', 'width': 3357, 'height': 4424, 'polygons': [{'name': 'rect', 'x': 596, 'y': 618, 'width': 1898, 'height': 1451}, {'name': 'rect', 'x': 543, 'y': 2331, 'width': 1998, 'height': 1437}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'missourimedicine5611miss_0352.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/missourimedicine5611miss_0352.jpg', 'width': 2513, 'height': 3695, 'polygons': [{'name': 'rect', 'x': 274, 'y': 530, 'width': 1075, 'height': 743}, {'name': 'rect', 'x': 271, 'y': 2052, 'width': 1075, 'height': 739}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b21932323_0188.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21932323_0188.jpg', 'width': 1811, 'height': 2946, 'polygons': [{'name': 'rect', 'x': 271, 'y': 612, 'width': 1315, 'height': 1362}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b22365977_0007.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b22365977_0007.jpg', 'width': 2642, 'height': 4292, 'polygons': [{'name': 'rect', 'x': 348, 'y': 556, 'width': 2064, 'height': 1657}, {'name': 'rect', 'x': 527, 'y': 2629, 'width': 1606, 'height': 1121}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'americantextbook00essi_0594.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/americantextbook00essi_0594.jpg', 'width': 2121, 'height': 3452, 'polygons': [{'name': 'rect', 'x': 157, 'y': 1619, 'width': 663, 'height': 324}, {'name': 'rect', 'x': 301, 'y': 2630, 'width': 779, 'height': 434}, {'name': 'rect', 'x': 1346, 'y': 2637, 'width': 492, 'height': 413}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'textbookofdental00burc_0367.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/textbookofdental00burc_0367.jpg', 'width': 1990, 'height': 3381, 'polygons': [{'name': 'rect', 'x': 211, 'y': 905, 'width': 1568, 'height': 1276}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'newyorkpresbyter00newy_2_0021.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/newyorkpresbyter00newy_2_0021.jpg', 'width': 2878, 'height': 3820, 'polygons': [{'name': 'rect', 'x': 563, 'y': 110, 'width': 813, 'height': 802}, {'name': 'rect', 'x': 1433, 'y': 113, 'width': 677, 'height': 794}, {'name': 'rect', 'x': 2148, 'y': 102, 'width': 609, 'height': 813}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'americanjournal46ameruoft_0062.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/americanjournal46ameruoft_0062.jpg', 'width': 2137, 'height': 3279, 'polygons': [{'name': 'rect', 'x': 552, 'y': 1137, 'width': 1156, 'height': 948}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': '63571000R_0947.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/63571000R_0947.jpg', 'width': 1980, 'height': 3528, 'polygons': [{'name': 'rect', 'x': 496, 'y': 1502, 'width': 1083, 'height': 1582}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
ERROR:root:Error processing image {'id': 'b21932323_0509.jpg', 'source': 'balloon', 'path': '../../datasets/illustrations/train/b21932323_0509.jpg', 'width': 1811, 'height': 2946, 'polygons': [{'name': 'rect', 'x': 198, 'y': 271, 'width': 1309, 'height': 1455}]}
Traceback (most recent call last):
  File "balloon.py", line 168, in load_mask
    rr, cc = skimage.draw.polygon(p['all_points_y'], p['all_points_x'])
KeyError: 'all_points_y'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1695, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 1210, in load_image_gt
    mask, class_ids = dataset.load_mask(image_id)
  File "balloon.py", line 171, in load_mask
    return mask.astype(np.bool), np.ones([mask.shape[-1]], dtype=mp.int32)
NameError: name 'mp' is not defined
Epoch 1/30
Traceback (most recent call last):
  File "balloon.py", line 376, in <module>
    train(model)
  File "balloon.py", line 211, in train
    layers='heads')
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/mask_rcnn-2.1-py3.6.egg/mrcnn/model.py", line 2328, in train
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/keras/engine/training.py", line 2194, in fit_generator
    generator_output = next(output_generator)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/keras/utils/data_utils.py", line 793, in get
    six.reraise(value.__class__, value, value.__traceback__)
  File "/home/fas/leonard/swk2/miniconda3/envs/maskRCNN/lib/python3.6/site-packages/six.py", line 693, in reraise
    raise value
NameError: name 'mp' is not defined
